import { usePortfolio } from "../../contexts/PortfolioContext";

const TabsBar = () => {
  const { openTabs, activeTab, openFile, closeFile } = usePortfolio();

  const getFileIcon = (fileName) => {
    if (fileName.endsWith(".jsx"))
      return {
        path: "M12 10.11c1.03 0 1.87.84 1.87 1.89 0 1-.84 1.85-1.87 1.85S10.13 13 10.13 12c0-1.05.84-1.89 1.87-1.89M7.37 20c.63.38 2.01-.2 3.6-1.7-.52-.59-1.03-1.23-1.51-1.9a22.7 22.7 0 0 1-2.4-.36c-.51 2.14-.32 3.61.31 3.96m.71-5.74l-.29-.51c-.11.29-.22.58-.29.86.27.06.57.11.88.16l-.3-.51m6.54-.76l.81-1.5-.81-1.5c-.3-.53-.62-1-.91-1.47C13.17 9 12.6 9 12 9s-1.17 0-1.71.03c-.29.47-.61.94-.91 1.47L8.57 12l.81 1.5c.3.53.62 1 .91 1.47.54.03 1.11.03 1.71.03s1.17 0 1.71-.03c.29-.47.61-.94.91-1.47M12 6.78c-.19.22-.39.45-.59.72h1.18c-.2-.27-.4-.5-.59-.72m0 10.44c.19-.22.39-.45.59-.72h-1.18c.2.27.4.5.59.72M16.62 4c-.62-.38-2 .2-3.59 1.7.52.59 1.03 1.23 1.51 1.9.82.08 1.63.2 2.4.36.51-2.14.32-3.61-.32-3.96m-.7 5.74l.29.51c.11-.29.22-.58.29-.86-.27-.06-.57-.11-.88-.16l.3.51m1.45-7.05c1.47.84 1.63 3.05 1.01 5.63 2.54.75 4.37 1.99 4.37 3.68s-1.83 2.93-4.37 3.68c.62 2.58.46 4.79-1.01 5.63-1.46.84-3.45-.12-5.37-1.95-1.92 1.83-3.91 2.79-5.37 1.95-1.47-.84-1.63-3.05-1.01-5.63-2.54-.75-4.37-1.99-4.37-3.68s1.83-2.93 4.37-3.68c-.62-2.58-.46-4.79 1.01-5.63 1.46-.84 3.45.12 5.37 1.95 1.92-1.83 3.91-2.79 5.37-1.95z",
        color: "#61DAFB",
      };
    if (fileName.endsWith(".js"))
      return {
        path: "M3 3h18v18H3V3zm16.525 13.708c-.272-.69-.686-.697-1.021-.697-.398 0-.64.155-.64.463 0 .306.155.463.463.696l.298.231c.155.154.231.307.231.54 0 .463-.386.772-.926.772-.617 0-1.021-.309-1.175-.772l-.462.231c.231.694.772 1.021 1.637 1.021.926 0 1.56-.463 1.56-1.175 0-.617-.309-.926-.772-1.175l-.298-.231c-.231-.154-.309-.231-.309-.386 0-.154.077-.231.231-.231.154 0 .309.077.386.231l.386-.231zm-3.633.077c-.231-.463-.617-.772-1.252-.772-.849 0-1.406.463-1.406 1.175 0 .849.617 1.021 1.406 1.021.694 0 1.175-.231 1.252-.772l-.463-.231c-.077.231-.309.386-.617.386-.309 0-.617-.154-.617-.463 0-.231.231-.463.617-.463.309 0 .54.154.617.386l.463-.231z",
        color: "#F7DF1E",
      };
    if (fileName.endsWith(".html"))
      return {
        path: "M1.5 0h21l-1.91 21.563L11.977 24l-8.565-2.438L1.5 0zm7.031 9.75l-.232-2.718 10.059.003.23-2.622L5.412 4.41l.698 8.01h9.126l-.326 3.426-2.91.804-2.955-.81-.188-2.11H6.248l.33 4.171L12 19.351l5.379-1.443.744-8.157H8.531z",
        color: "#E34F26",
      };
    if (fileName.endsWith(".md"))
      return {
        path: "M2 4v16h20V4H2zm18 14H4V6h16v12zM8 8H6v8h2v-2h2v2h2V8h-2v4H8V8zm6 0v8h2v-6h2v6h2V8h-6z",
        color: "var(--text-primary)",
      };
    if (fileName.endsWith(".pdf"))
      return {
        path: "M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z",
        color: "#F40F02",
      };
    if (fileName.endsWith(".git"))
      return {
        path: "M16 1.75a.75.75 0 0 0-1.5 0V3a.75.75 0 0 0 1.5 0V1.75zM8 4a1 1 0 1 0 0 2 1 1 0 0 0 0-2zm4.5 1.75a.75.75 0 0 0-1.5 0V7a.75.75 0 0 0 1.5 0V5.75zM8 8a1 1 0 1 0 0 2 1 1 0 0 0 0-2zM4.5 8.25a.75.75 0 0 0-1.5 0V12a.75.75 0 0 0 1.5 0V8.25zM12 11a1 1 0 1 0 0 2 1 1 0 0 0 0-2zM8.006 14a1 1 0 1 0-2 0 1 1 0 0 0 2 0z",
        color: "#F05033",
      };
    return {
      path: "M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z",
      color: "var(--text-secondary)",
    };
  };

  if (openTabs.size === 0) return <div className="tabs-bar"></div>;

  return (
    <div className="tabs-bar">
      {Array.from(openTabs.entries()).map(([fileName, tabData]) => {
        const icon = getFileIcon(fileName);
        return (
          <div
            key={fileName}
            className={`tab ${activeTab === fileName ? "active" : ""}`}
            onClick={() => openFile(fileName)}
          >
            <svg
              className="tab-icon"
              width="16"
              height="16"
              viewBox="0 0 24 24"
              fill={icon.color}
              aria-hidden="true"
            >
              <path d={icon.path} />
            </svg>
            {fileName}
            <svg
              className="close-icon"
              width="16"
              height="16"
              viewBox="0 0 24 24"
              fill="currentColor"
              onClick={(e) => {
                e.stopPropagation();
                closeFile(fileName);
              }}
            >
              <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z" />
            </svg>
          </div>
        );
      })}
    </div>
  );
};

export default TabsBar;
